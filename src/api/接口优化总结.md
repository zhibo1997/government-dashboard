# API æ¥å£ä¼˜åŒ–æ€»ç»“

## âœ… å·²å®Œæˆçš„ä¼˜åŒ–

### 1. æ ¸å¿ƒæ¶æ„é‡æ„

#### åˆ›å»ºçš„æ–‡ä»¶
- âœ… `src/api/apiConfig.ts` - ä¸šåŠ¡æ¨¡å—å‚æ•°é…ç½®ç®¡ç†
- âœ… `src/api/apiFactory.ts` - æ³›å‹ API å·¥å‚å‡½æ•°ï¼ˆæ”¯æŒä»»æ„ swagger æ¨¡å—ï¼‰
- âœ… `src/api/index.ts` - ç»Ÿä¸€å¯¼å‡ºå…¥å£ï¼ˆå·²é‡æ„ï¼‰
- âœ… `src/services/commonService.ts` - é€šç”¨æœåŠ¡å±‚ï¼ˆç™»å½•ã€æ•°æ®å­—å…¸ï¼‰
- âœ… `src/services/waterSupplyService.ts` - ä¾›æ°´æ¨¡å—æœåŠ¡å±‚

#### ç”Ÿæˆçš„ API æ¨¡å—
- âœ… `src/api/common.ts` - é€šç”¨æ¨¡å—ï¼ˆç™»å½•ã€å­—å…¸ï¼‰- swagger è‡ªåŠ¨ç”Ÿæˆ
- âœ… `src/api/waterSupplyAndDrainage.ts` - ä¾›æ°´æ’æ°´æ¨¡å— - swagger è‡ªåŠ¨ç”Ÿæˆ

### 2. å·²è¿ç§»çš„ç»„ä»¶

#### OverviewModule.vue
**å˜æ›´å‰**:
```typescript
import api from '@/api/openApi'
const res = await api.overviewData.List()
```

**å˜æ›´å**:
```typescript
import { getWaterOverview } from '@/services/waterSupplyService'
const data = await getWaterOverview()
```

#### LoginView.vue
**å˜æ›´å‰**:
```typescript
import { loginService } from '@/services/loginService'
const result = await loginService.login(formData.value)
```

**å˜æ›´å**:
```typescript
import { login } from '@/services/commonService'
const result = await login(formData.value.username, formData.value.password)
```

### 3. ä¼˜åŒ–äº®ç‚¹

1. **ä¿ç•™ swagger ç±»å°è£…** âœ…
   - HttpClient ä¿ç•™ä¸åŠ¨
   - æ‰€æœ‰ç”Ÿæˆçš„ä»£ç ä¿æŒåŸæ ·
   - é€šè¿‡å·¥å‚å‡½æ•°ç»Ÿä¸€é…ç½®

2. **æ³›å‹å·¥å‚æ¨¡å¼** âœ…
   ```typescript
   export function createApiClient<TClient extends ApiClientBase>(
     ApiCtor: ApiConstructor<TClient>,
     options: ApiClientOptions = {}
   ): TClient
   ```
   - æ”¯æŒä»»æ„ swagger ç”Ÿæˆçš„ Api ç±»
   - ç»Ÿä¸€æ‹¦æˆªå™¨é…ç½®
   - çµæ´»çš„å‚æ•°æ³¨å…¥

3. **æœåŠ¡å±‚å‡½æ•°å°è£…** âœ…
   - ç»„ä»¶ä¸­ä½¿ç”¨æ›´ç®€æ´
   - ç›´æ¥è¿”å›æ•°æ®ï¼Œæ— éœ€è§£æ response
   - ä¾¿äºæµ‹è¯•å’Œç»´æŠ¤

4. **æ–‡æ¡£ç²¾ç®€** âœ…
   - åªä¿ç•™ README.mdï¼ˆä½¿ç”¨æŒ‡å—ï¼‰
   - åˆ é™¤äº† 5 ä¸ªå†—ä½™çš„ MD æ–‡æ¡£
   - ç®€æ´æ˜äº†

## ğŸš€ ä½¿ç”¨æ–¹å¼

### æ–¹å¼ 1ï¼šæœåŠ¡å±‚å‡½æ•°ï¼ˆæ¨èï¼‰

```typescript
import { login } from '@/services/commonService'
import { getWaterOverview } from '@/services/waterSupplyService'

// ç™»å½•
const data = await login('username', 'password')

// è·å–ä¾›æ°´æ€»è§ˆ
const overview = await getWaterOverview()
```

### æ–¹å¼ 2ï¼šAPI å®¢æˆ·ç«¯

```typescript
import { createWaterSupplyApi, createCommonApi } from '@/api'

const waterApi = createWaterSupplyApi()
const commonApi = createCommonApi()

// è°ƒç”¨æ¥å£
const res = await waterApi.overviewData.List()
const publicKey = await commonApi.login.publicKeyList()
```

## ğŸ“¦ æ·»åŠ æ–°æ¨¡å—ç¤ºä¾‹

### ç‡ƒæ°”æ¨¡å—

```bash
# 1. ç”Ÿæˆ API å®¢æˆ·ç«¯
npx swagger-typescript-api \
  -p "http://your-api/swagger.json" \
  -o ./src/api/ \
  -n gas \
  --axios
```

```typescript
// 2. åœ¨ apiFactory.ts ä¸­æ·»åŠ 
import { Api as GasApi } from './gas'

export function createGasApi(): GasApi<unknown> {
  return createApiClient(GasApi, { module: BusinessModule.GAS })
}
```

```typescript
// 3. åˆ›å»ºæœåŠ¡å±‚ï¼ˆå¯é€‰ï¼‰
// src/services/gasService.ts
import { createGasApi } from '@/api/apiFactory'

const gasApi = createGasApi()

export async function getGasOverview() {
  const res = await gasApi.overview.List()
  return res.data
}
```

## ğŸ¯ æ ¸å¿ƒä¼˜åŠ¿

1. **ä½æˆæœ¬** - ä¿ç•™ swagger ç”Ÿæˆä»£ç ï¼Œæ— éœ€æ‰‹åŠ¨ç»´æŠ¤
2. **æ˜“æ‰©å±•** - æ³›å‹å·¥å‚æ”¯æŒä»»æ„æ–°æ¨¡å—
3. **æ˜“ä½¿ç”¨** - æœåŠ¡å±‚å‡½æ•°ç®€åŒ–è°ƒç”¨
4. **ç±»å‹å®‰å…¨** - å®Œæ•´çš„ TypeScript æ”¯æŒ
5. **å‘åå…¼å®¹** - æ—§ä»£ç ä»å¯è¿è¡Œ

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [API ä½¿ç”¨æŒ‡å—](./README.md)
- [ä»£ç ç¤ºä¾‹](./apiFactory.ts)
- [é…ç½®è¯´æ˜](./apiConfig.ts)

---

**ä¼˜åŒ–å®Œæˆæ—¶é—´**: 2025-10-25  
**æŠ€æœ¯æ ˆ**: Vue 3 + TypeScript + Axios + Swagger TypeScript API  
**çŠ¶æ€**: âœ… ä¼˜åŒ–å®Œæˆï¼Œå·²è¿ç§» 2 ä¸ªç»„ä»¶
